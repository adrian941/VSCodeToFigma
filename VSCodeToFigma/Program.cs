using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

namespace VSCodeToFigma
{
    public partial class Program
    {
        [DllImport("user32.dll")]
        private static extern bool AddClipboardFormatListener(IntPtr hwnd);

        [DllImport("user32.dll")]
        private static extern bool RemoveClipboardFormatListener(IntPtr hwnd);

        private const int WM_CLIPBOARDUPDATE = 0x031D;

        private static void Main(string[] args)
        {

            if (args.Length == 445141)
            {
                Application.Exit();
            }
            NotifyIcon notifyIcon = new NotifyIcon
            {
                Icon = SystemIcons.Information,
                Visible = true,
                BalloonTipTitle = $"VSCodeToFigma Service Started !",
                BalloonTipText = $"Service Started !",

            };
            notifyIcon.ShowBalloonTip(2000);


            //string html = "<!--StartFragment--><div style=\"padding: 10px; display: inline-block; width: fit-content; color: #d4d4d4;background-color: #1e1e1e;font-family: Consolas, 'Courier New', monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;\"><div><span style=\"color: #569cd6;\">using</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">Microsoft</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">AspNetCore</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">Mvc</span><span style=\"color: #d4d4d4;\">;</span></div><br><div><span style=\"color: #569cd6;\">namespace</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">ReactApp1</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">Server</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">Controllers</span><span style=\"color: #d4d4d4;\">;</span></div><br><div><span style=\"color: #d4d4d4;\">[</span><span style=\"color: #4ec9b0;\">ApiController</span><span style=\"color: #d4d4d4;\">]</span></div><div><span style=\"color: #d4d4d4;\">[</span><span style=\"color: #4ec9b0;\">Route</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #ce9178;\">\"</span><span style=\"color: #2eabfe;\">[</span><span style=\"color: #2eabfe;\">controller</span><span style=\"color: #2eabfe;\">]</span><span style=\"color: #ce9178;\">\"</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">]</span></div><div><span style=\"color: #569cd6;\">public</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #569cd6;\">class</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #4ec9b0;\">WeatherForecastController</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #b8d7a3;\">ILogger</span><span style=\"color: #d4d4d4;\">&lt;</span><span style=\"color: #4ec9b0;\">WeatherForecastController</span><span style=\"color: #d4d4d4;\">&gt;</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #9cdcfe;\">logger</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">:</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #4ec9b0;\">ControllerBase</span></div><div><span style=\"color: #d4d4d4;\">{</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #569cd6;\">private</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #569cd6;\">static</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #569cd6;\">readonly</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #569cd6;\">string</span><span style=\"color: #d4d4d4;\">[</span><span style=\"color: #d4d4d4;\">]</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">_summaries</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">=</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #d4d4d4;\">[</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; &#160; &#160; </span><span style=\"color: #ce9178;\">\"Freezing\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Bracing\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Chilly\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Cool\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Mild\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Warm\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Balmy\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Hot\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Sweltering\"</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"Scorching\"</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #d4d4d4;\">]</span><span style=\"color: #d4d4d4;\">;</span></div><br><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #569cd6;\">private</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #569cd6;\">readonly</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #b8d7a3;\">ILogger</span><span style=\"color: #d4d4d4;\">&lt;</span><span style=\"color: #4ec9b0;\">WeatherForecastController</span><span style=\"color: #d4d4d4;\">&gt;</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">_logger</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">=</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #9cdcfe;\">logger</span><span style=\"color: #d4d4d4;\">;</span></div><br><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #d4d4d4;\">[</span><span style=\"color: #4ec9b0;\">HttpGet</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #d4d4d4;\">Name</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">=</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #ce9178;\">\"GetWeatherForecast\"</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">]</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #569cd6;\">public</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #b8d7a3;\">IEnumerable</span><span style=\"color: #d4d4d4;\">&lt;</span><span style=\"color: #4ec9b0;\">WeatherForecast</span><span style=\"color: #d4d4d4;\">&gt;</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #dcdcaa;\">Get</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #d4d4d4;\">)</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #d4d4d4;\">{</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; &#160; &#160; </span><span style=\"color: #c586c0;\">return</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">[</span><span style=\"color: #d4d4d4;\">..</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #4ec9b0;\">Enumerable</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #dcdcaa;\">Range</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #b5cea8;\">1</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #b5cea8;\">5</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #dcdcaa;\">Select</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #9cdcfe;\">index</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">=&gt;</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #569cd6;\">new</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #4ec9b0;\">WeatherForecast</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; &#160; &#160; </span><span style=\"color: #d4d4d4;\">{</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style=\"color: #d4d4d4;\">Date</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">=</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #86c691;\">DateOnly</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #dcdcaa;\">FromDateTime</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #86c691;\">DateTime</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">Now</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #dcdcaa;\">AddDays</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #9cdcfe;\">index</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">,</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style=\"color: #d4d4d4;\">TemperatureC</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">=</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #4ec9b0;\">Random</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">Shared</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #dcdcaa;\">Next</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #d4d4d4;\">-</span><span style=\"color: #b5cea8;\">20</span><span style=\"color: #d4d4d4;\">,</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #b5cea8;\">55</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">,</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; &#160; &#160; &#160; &#160; </span><span style=\"color: #d4d4d4;\">Summary</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">=</span><span style=\"color: #d4d4d4;\"> </span><span style=\"color: #d4d4d4;\">_summaries</span><span style=\"color: #d4d4d4;\">[</span><span style=\"color: #4ec9b0;\">Random</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">Shared</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #dcdcaa;\">Next</span><span style=\"color: #d4d4d4;\">(</span><span style=\"color: #d4d4d4;\">_summaries</span><span style=\"color: #d4d4d4;\">.</span><span style=\"color: #d4d4d4;\">Length</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">]</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; &#160; &#160; </span><span style=\"color: #d4d4d4;\">}</span><span style=\"color: #d4d4d4;\">)</span><span style=\"color: #d4d4d4;\">]</span><span style=\"color: #d4d4d4;\">;</span></div><div><span style=\"color: #d4d4d4;\">&#160; &#160; </span><span style=\"color: #d4d4d4;\">}</span></div><div><span style=\"color: #d4d4d4;\">}</span></div><br></div><!--EndFragment-->";
            //HtmlToSvgAdi.Convert(html, 1200, 0, @"A:\Desktop\Site\Hello.svg");

            var thread = new Thread(() =>
            {
                ClipboardWatcher watcher = new ClipboardWatcher();
                Application.Run(); // ține threadul viu pentru mesaje Win32
            });
            thread.SetApartmentState(ApartmentState.STA);
            thread.Start();




        }
    }
}
